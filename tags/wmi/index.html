<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<title>wmi</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-19900770-2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-19900770-2")</script>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=alternate type=application/rss+xml href=https://trukhanov.com/index.xml title="Perpetuum informatio - Never ending IT story">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="wmi">
<meta name=twitter:description content>
<link rel=stylesheet href=https://trukhanov.com/fontawesome/css/all.min.css>
<link crossorigin=anonymous href=/css/styles.min.css integrity rel="preload stylesheet" as=style>
<link rel=stylesheet href=https://trukhanov.com/css/custom.css>
<link id=dark-mode-theme crossorigin=anonymous href=/css/dark.min.css integrity rel="preload stylesheet" as=style>
<script>var darkTheme=document.getElementById("dark-mode-theme"),storedTheme=localStorage.getItem("dark-mode-storage");storedTheme==="dark"?darkTheme.disabled=!1:storedTheme==="light"&&(darkTheme.disabled=!0)</script>
<script defer crossorigin=anonymous src=/js/theme.js integrity></script>
<script defer crossorigin=anonymous src=/js/instantpage.min.js integrity></script><meta name=generator content="Hugo 0.93.0">
</head><body>
<header>
<nav class=navbar>
<div class=nav>
<ul class=nav-links>
</ul></div></nav><div class=intro-header>
<div class=container>
<div class=tags-heading>
<h1>
wmi
</h1></div></div></div></header><div class=container role=main>
<div class=posts-list>
<article class=post-preview>
<a href=https://trukhanov.com/2017/06/script-for-windows-storage-audit/>
<h2 class=post-title>Script for Windows storage audit</h2></a>
<div class=post-entry>
<p><p>I’ve created PowerShell script to collect all important information about windows physical disks, partitions and volumes (logical disks) and its connections.</p></p><a href=https://trukhanov.com/2017/06/script-for-windows-storage-audit/ class=post-read-more>Read More</a>
</div><div class=postmeta>
<span class=meta-post>
<em class="fa fa-calendar-alt"></em>&nbsp;Jun 17, 2017
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://trukhanov.com/categories/Uncategorized/>Uncategorized</a>&nbsp;
</span>
</div></article><article class=post-preview>
<a href=https://trukhanov.com/2017/06/windows-storage-hierarchy-explained/>
<h2 class=post-title>Windows storage hierarchy explained</h2></a>
<div class=post-entry>
<p><p>Quick cheat sheet:</p><ol>
<li>Physical disk, represented by Win32_DiskDrive and MSFT_Disk WMI classes. This is hardware presented to your computer. It is HDD, SSD, FC LUN or iSCSI LUN.</li><li>Partition, represented by Win32_DiskPartition and MSFT_Partition WMI classes. Partitions are walls that transforming your physical space into rooms, which later can be used to store your data. Physical disk can have 0 or more partitions.</li><li>Volume, represented by Win32_Volume and MSFT_Volume WMI classes. Volumes are named spaces, from abstract rooms you get living room, kitchen and bedrooms. You format room to make it “named room”. Or in other words, you format partition to some file system, i.e. NTFS, FAT or ReFS. Volumes can store data and provide access to it. One partition can have 0 or 1 volume. When partition has 0 volume, in most cases this means that there is no data accessible by user.</li></ol></p><a href=https://trukhanov.com/2017/06/windows-storage-hierarchy-explained/ class=post-read-more>Read More</a>
</div><div class=postmeta>
<span class=meta-post>
<em class="fa fa-calendar-alt"></em>&nbsp;Jun 17, 2017
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://trukhanov.com/categories/Windows-Server/>Windows Server</a>&nbsp;
</span>
</div></article><article class=post-preview>
<a href=https://trukhanov.com/2015/09/limit-group-policy-only-to-client-os/>
<h2 class=post-title>Limit group policy only to client OS</h2></a>
<div class=post-entry>
<p><p>Sometimes you want to apply your policy to every client PC in many OUs. To do such you can use WMI filter. This is especially useful in messy AD structures, where is no dedicated OU for client computer objects.</p><pre tabindex=0><code>Namespace: root\CIMv2
Query: select * from Win32_OperatingSystem where ProductType=&#34;1&#34;
</code></pre></p><a href=https://trukhanov.com/2015/09/limit-group-policy-only-to-client-os/ class=post-read-more>Read More</a>
</div><div class=postmeta>
<span class=meta-post>
<em class="fa fa-calendar-alt"></em>&nbsp;Sep 3, 2015
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://trukhanov.com/categories/Active-Directory/>Active Directory</a>&nbsp;
</span>
</div></article><article class=post-preview>
<a href=https://trukhanov.com/2015/07/tmg-2010-and-rpc-server-unavailable/>
<h2 class=post-title>TMG 2010 and “RPC Server unavailable”</h2></a>
<div class=post-entry>
<p><p>Recently I have encountered strange TMG behavior. I have permitted all RPC connections to Domain Controllers with system rule and disabled RPC Filter plus switched off “Enable strict RPC compliance” option. But my WMI requests and any other RPC traffic from TMG servers to internal resources was still blocked.</p></p><a href=https://trukhanov.com/2015/07/tmg-2010-and-rpc-server-unavailable/ class=post-read-more>Read More</a>
</div><div class=postmeta>
<span class=meta-post>
<em class="fa fa-calendar-alt"></em>&nbsp;Jul 14, 2015
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://trukhanov.com/categories/Uncategorized/>Uncategorized</a>&nbsp;
</span>
</div></article></div></div><footer>
<div class=social-icons>
</div><div class=container>
<p class="credits copyright">
<a href=https://trukhanov.com/about></a>
&nbsp;&copy;
2017
&nbsp;/&nbsp;
<a href=https://trukhanov.com/>Perpetuum informatio - Never ending IT story</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em>
</p><p class="credits theme-by">
Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a>
</p></div></footer></body></html>